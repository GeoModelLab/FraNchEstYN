% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Main.R
\name{franchestyn}
\alias{franchestyn}
\title{Run the FraNchEstYN crop–disease simulation or calibration}
\usage{
franchestyn(
  weather_data,
  management_data,
  reference_data = NULL,
  cropParameters = NULL,
  diseaseParameters = NULL,
  fungicideParameters = NULL,
  calibration = "disease",
  start_end = c(2000, 2025),
  apikey = NULL,
  franchy_message = FALSE,
  ...,
  cleanup_outputs = TRUE
)
}
\arguments{
\item{weather_data}{A data frame of daily or hourly weather for \strong{one site only}.
  The function will detect if input is daily or hourly.
  Column names are matched case-insensitively, ignoring spaces, underscores, and dashes.

  \strong{Date columns (mandatory):}

  Provide the combination of \code{year}, \code{month}, \code{day}
  (and optionally \code{hour} for hourly data).

  \strong{Meteorological variables:}

  \emph{Mandatory:}
  \itemize{
    \item Daily inputs: \code{tmax}, \code{tx}, \code{t2mmax}, \code{maxtemp}
          (max temperature, °C),
          \code{tmin}, \code{tn}, \code{t2mmin}, \code{mintemp}
          (min temperature, °C),
          \code{precipitation}, \code{prec}, \code{p}, \code{rainfall}, \code{rain}
          (mm d\eqn{^{-1}}).
    \item Hourly inputs: \code{temp}, \code{temperature}, \code{t2m}
          (air temperature, °C),
          \code{precipitation}, \code{prec}, \code{precip}, \code{prectotcorr},
          \code{rainfall}, \code{rain} (mm h\eqn{^{-1}}).
  }

  \emph{Radiation or Latitude (one required):}
  \itemize{
    \item Radiation: \code{rad}, \code{solar}, \code{solarrad} [MJ m\eqn{^{-2}} d\eqn{^{-1}}]
    \item Latitude: \code{lat}, \code{latitude}, \code{site_lat} [decimal degrees]
  }
  If radiation is missing, it will be estimated from latitude and day length.

  \emph{Optional variables (used if present, estimated otherwise):}
  \itemize{
    \item Relative humidity:
      \code{rh}, \code{humidity}, \code{relhumidity}, \code{relativehumidity} (hourly),
      \code{rhmax}, \code{rhx} and \code{rhmin}, \code{rhn} (daily).
    \item Leaf wetness: not required — computed internally from
      humidity > 90\% or rainfall ≥ 0.2 mm/h.
  }}

\item{management_data}{A data frame with management information for the
  \strong{same site} as \code{weather_data}. Column matching is case-insensitive;
  spaces/underscores/dashes are ignored and normalized to snake_case.

  \strong{Required columns:}
  \itemize{
    \item \code{crop} — character (e.g., "Wheat").
    \item \code{sowingDOY} — integer DOY in \code{[1, 366]}.
    \item \code{year} — either an ISO year (YYYY) or the string \code{"All"}.
  }

  \strong{Optional:}
  \itemize{
    \item \code{treatment} — character with one or more fungicide dates
          separated by commas/semicolons (e.g., \code{"12 Feb; 28 Feb"}).
  }}

\item{reference_data}{An optional data frame with observations;
  **required when** \code{calibration != "none"}.
  Column names are matched case-insensitively, spaces trimmed, and aliases accepted.

  \strong{Minimum requirement for disease calibration:}
  Must contain a disease severity column:
  \code{DiseaseSeverity}, \code{dissev}, or \code{disease}.
  Values should be fractional in \code{[0,1]}.

  Recommended alignment: year + DOY
  (\code{year}/\code{yr} + \code{doy}/\code{day_of_year}).}

\item{cropParameters}{A named list of crop parameters
(see \code{data(cropParameters)}).}

\item{diseaseParameters}{A named list of disease parameters
(see \code{data(diseaseParameters)}).}

\item{fungicideParameters}{Optional list of fungicide parameters
(see \code{data(fungicideParameters)}).}

\item{calibration}{Character. What to calibrate:
\code{"none"}, \code{"crop"}, \code{"disease"}, or \code{"all"}.}

\item{start_end}{Numeric vector of length 2. Start and end years for simulation
(default: \code{c(2000, 2025)}).}

\item{apikey}{Optional string. API key for enabling LLM-based commentary.
Generated at \url{https://openrouter.ai/}.}

\item{franchy_message}{Logical. If TRUE, generate commentary via LLM.}

\item{...}{Advanced options (hidden). Currently supports:
\code{iterations} (integer; default 100).}

\item{cleanup_outputs}{Logical. If TRUE, delete outputs after run. Default = TRUE.}
}
\value{
A list with elements: \code{outputs}, \code{diagnostics},
  \code{parameters}, \code{spooky_message}.
}
\description{
Runs the FraNchEstYN model. The function prepares inputs
(weather, management, parameters, reference) and launches the executable.
Users do not manage paths or config files manually.
}
\details{
- Only one site per run.
- Column names matched case-insensitively, tolerant to spaces, underscores, and dashes.
}
\examples{
\dontrun{
franchestyn(
  weather_data        = weather_df,
  management_data     = mgmt_df,
  reference_data      = ref_df,
  cropParameters      = cropParameters$wheat,
  diseaseParameters   = diseaseParameters$septoria,
  fungicideParameters = fungicideParameters$protectant,
  calibration         = "all",
  start_end           = c(2010, 2020),
  apikey              = "sk-or-v1-xxxx",
  franchy_message     = TRUE,
  iterations          = 200
)
}
}
